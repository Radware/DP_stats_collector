{
   "aggregation":{
      "criteria":[
         {
            "type":"termFilter",
            "field":"monitoringProtocol",
            "value":"all",
            "inverseFilter":false
         },
         {
            "type":"termFilter",
            "field":"unit",
            "value":"bps",
            "inverseFilter":false
         },
         {
            "type":"termFilter",
            "field":"direction",
            "value":"Inbound",
            "inverseFilter":false
         },
         {
            "type":"timeFilter",
            "inverseFilter":false,
            "field":"timeStamp",
            "lower":1626281040000,
            "upper":null,
            "includeLower":true,
            "includeUpper":true
         },
         {
            "type":"orFilter",
            "inverseFilter":false,
            "filters":[
               {
                  "type":"andFilter",
                  "inverseFilter":false,
                  "filters":[
                     {
                        "type":"termFilter",
                        "inverseFilter":false,
                        "field":"deviceIp",
                        "value":"$ DefensePro IP Variable"
                     },
                     {
                        "type":"orFilter",
                        "inverseFilter":false,
                        "filters":[
                           {
                              "type":"termFilter",
                              "inverseFilter":false,
                              "field":"policyName",
                              "value":"$ Policy Variable"
                           }
                        ]
                     }
                  ]
               }
            ]
         }
      ],
      "type":"dateHistogram",
      "aggField":"timeStamp",
      "aggName":"timeStamp",
      "aggregation":{
         "type":"calculation",
         "aggField":null,
         "aggName":null,
         "metrices":[
            {
               "type":"sumMetric",
               "aggName":"trafficValue",
               "aggField":"trafficValue"
            },
            {
               "type":"sumMetric",
               "aggName":"excluded",
               "aggField":"excluded"
            },
            {
               "type":"sumMetric",
               "aggName":"discards",
               "aggField":"discards"
            }
         ]
      },
      "timeInterval":{
         "dateFraction":"HOUR",
         "amount":1
      }
   },
   "order":[
      {
         "type":"Order",
         "order":"ASC",
         "aggregationName":null,
         "field":"timeStamp",
         "sortingType":"LONG"
      }
   ]
}